apiVersion: v1
kind: Config
preferences: {}

clusters:
#cluster info about mgmt-cluster (for linode take the ip address of linode ec2)
- cluster:
    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeU1ERXlNVEE1TVRreU5Gb1hEVE15TURFeE9UQTVNVGt5TkZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTWZGCm5Lamcram9MOS9FUzE1M0VxYWdvd1gzM1NxUmw5Q2ZHT3QzVkhiZjVocmtQWWc2RllzYnBoSHBLK2tLY1FBMWoKZ1JjN2dPdXdHc3pkREc1YXY3U3l5T1N5eWJwWjJBZE0xZGQrbm9teU01UzlkUWxIeUhGM2Vqck5wa2pXQ0VuLwpJK2Ewb2lFU1g3NXhPNHJjWFRTQk5uZk1QbndaTU4zcTNwbmI1eDZLdnhmYlcxNkdkR1liQytweUMxUkxZMUtNCjNHZ0pWSWNIQWFZWUlkbi90RHlXUDU3U1FOcTNydG9MMm50ZkJxRDMzRWNSaFB5UkJXQ2FoODAvWE5BbXppRC8KVEthMXZWa202c3BLTlkyNnlrMHJCdm1MenhocjhqVUlmME12bGhPZW9mZnVPcGlNNGw4Rm12QWd4a0l3eGM0SgpjL2NpZVJzeUVvS3NmUmtYOG1jQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZOM0tBYkg0Z09NbFZKTzZXblNyVTUrTnhDd3dNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFBUWpOQXV2UTZrSWtReUxpWC80bnJpWkJCRmhteXdVNDFGVzhBNmJFZWlMUUxiRStudwpoaFFLdC9VSWxpVkRTaGdjSGZzZ0o3VUtya2ZzMU5UVU13azZZVk1vaDREdWhUN2R0ejlwclJ4VEZSeXAyUEdEClRVNDJ3ZWQ2WVVmNm5wb0kzWE9MOEpWdVNDcDFaeFAzVk1FbENpNjZEekE5SmU1YVpJZ2hFa0NLWklVTnZxNHkKTlhJaEpiWmVkMm9abS9sUEpGU3Z2bTE1bmZVQjVTeHR0RWdkQzNQc00zSk41bURPZXZkT2tZREl3dDl4aTRSMAo5YUs2b1grdDNkM3NGWExxWmRBRTZkT1dCWHpJRFZZWVdXaWR6WlhXelY5MmRxTmhFVWVla1pWMXdmeGMxOWd3CjNJMkxuVGo5Vkd6d2JlSU5DNURyTHlLRklBVXIvYXBSb3lZSgotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    server: https://79875cb8-c00c-49eb-9c47-0764242354cd.eu-west-1.linodelke.net:443
  name: lke50149
#cluster info about cluster-1
- cluster:
    insecure-skip-tls-verify: true
    server: https://178.79.142.241:38487
  name: cluster1
#cluster info about cluster-2
- cluster:
    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeU1ERXlNVEE1TVRrMU1Gb1hEVE15TURFeE9UQTVNVGsxTUZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTFBLCmxCbDZDMkhrMERQTHk5MWg1b1pDZGFJckVyYlBxcEVoYkZFTzA1dU0wMU11OVpDdERIQUdLckdZK3dsckkrZGEKUnpTV0hFaXVzcTMvVFVQVHNDd0IvYXl1TmI5QTQyRmhXMjRLNGhrZVhtRFBiSlBtKzczNTRvKzBTbzkvaDNDbwo4N1RHa1VsbnBrSHJCVjVtMHJQOFJTTlc4WE9oUGRHS1g1VVVobHh6N29QbENGSGkxNkk5MGtMd3RYNi9IaU9PCmxVVjdGNHpXekVlTWw3U0Zxd1VVYm5GVTE2dnJ6clUwZzAyamYwWXBiS3dXektOaURpVk5rbXB1WGRjOWhKSkUKUXBEWFg5UVhJK2NLUlFXVUU0ZXdLaElMZEt1a0VJNEVCQ0t5UDErRVExMVBFbUZrVk1LTTV4SlpBakNLNkExZApVSW9OSUpac0FlS1VVNG01cmk4Q0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZOWmgwODI4N092S3p6VUpUU1pJZXk3SjJwMkRNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFCVmlveUliVzZ3eXpIU1hQVkFFdVRuV1l3QnZ2SGsxOEpVOGlBUFFPS2xuMHZ1emVvUQppSUtOamVTcjBkSHhSOWRjajNrVjdxanpmejVTdCtYVXIrUDNJMzZCV0t4VHNBNnZOK1NDamlDSVpaZHZZT2xJCjNVcVhqYTFDb3lnOGZqN3NDSXd4cnRYZHd0UjFPVTI2ZW82eXJNd3pPNldxL3h5QWVkOUEyaXdNYnBHbFYyNysKdngzUGVFTUVSOXg0M1VjYVlxSG14NUdCNStEVXZvU0J3eUdPYVh2MUhxdXhLemhLUW1PeDNRYTNqWTRrZkdMdwppa05GQmhqMlZLdW9SN3B6WnFzSldLcit3RGY5YVFGZnZNY3pWVk9URVZEQjZrdTdQZWMzcW9VcWs4Ry9rUUFXClphZmF5c2haQis5Yzh3THZFV2hRNkR4NnRmemwyUlNqQnZUQQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    server: https://a0137e6a-ae78-4a54-abeb-89129189840a.eu-west-2.linodelke.net:443
  name: lke50150
users:
#user info about mgmt-cluster
- name: lke50149-admin
  user:
    as-user-extra: {}
    token: eyJhbGciOiJSUzI1NiIsImtpZCI6IjdMZWU4YlJxeFIwRU5MLWlHaDVqU0Q3dGgzWlNWVjNDNThFc0t3QjZLcUEifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJsa2UtYWRtaW4tdG9rZW4tcnd0Y3oiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoibGtlLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiZTBmNDQ5YzUtYWQxNy00NjlhLWI1ZTktZGIxM2Y2MzI1NmYyIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmxrZS1hZG1pbiJ9.AXTRq2Wt3hkFcio1-qt4zG7D95VcEn8HVl2cAVS1NVQflFA2b0lCdqbjo0K2On9Cg0K5WegTursLxOmKOnhA5g7R6PQYZb7TSwe_WieVyit44P99LjBg0J37DHgLu0dO8FgVI47q3zVrMVH8SCFPgjD4iijxzrW5sL0UprtaOoLjZftHnWDohA2xvivniErxnlOydhMc7Zn0slfIzOZKbJrV64aKuHAnBP1D315zLYk5B_HAXirYJ4k4t8xwUUic8808Cq0M7fbOtJlFXNU9D5ulzFNaaqm5tOG4SIxeivpFi0fXe32mBcKC0FXmoofWz-B8fU4iJdwCHhTYIsiwDA
#user info about cluster-1
- name: cluster1-admin
  user:
    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM4akNDQWRxZ0F3SUJBZ0lJVU8wZFJVMmNkelV3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TWpBeE1qRXdPVEkxTXpGYUZ3MHlNekF4TWpFd09UTXdNekphTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTNkT1FiVFVzZUxlcXkvc0sKM2MrSG5nb29IM1FOMGxyczRwY2k1RTUyd3pRUlN3b2kyd1ZQOFBEajM4a0pyaXk2N2d5NXVKMkhFUVJDME5rawoyWFlIU0N6R2FZd2VPa0dCSHRzeGxIN2ZLYzZSaHlsdUVRT1VudlphZnVzenJWNS9zdkNIMEV4TWpTRkVXUkNNCnViRFVUdnMxMDlLaGxqVjBVcjIyamN3SjlSMHEvQWlMbTVZM25zN0dyMzhrUlJSQUpJYk81NnJjbG1aNlVxYWQKVkZ2UlIvdnJkZXdMcTVjbnBKcVBEbWwrN2ROT2tJYUVEQzVOcXowSlRrMnkxV2x6QUY3a1IvQTVkZ2dycDJSMApXZ01aYTBpUmVIb1laTDB1SThYRUpoWmtwRDNaVlQ5VjUvUGEvSGJsUmJ1cjNIQmdaQXB5eGg2V2lRaUtlSC9vCjk2bU9SUUlEQVFBQm95Y3dKVEFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFLaEtQaUJKNGhUYWRidVJPNjJOMWkxTjduR0QwSC9ZcWwybwo2b1BGWFNnWVJ1VE02U3R6ckdnZmcvTFJmQ3lOZjBQWDZaVW1hN21XRGdzazB3SlNpdmpyNmFFSHhnTWVDNmtiCnJ0eEVDL0lxTUNQWU5IN3VXOUVtRDZMMXVyeTdobFBFQk9NaGdlellLR2h0SFBiNHN1b3BXVVRLQytOdW1VWlIKUGQ2eVlRK1VDUzBOVXcvdHNDOGVlT3NoYWpXVnhUUWRBbTI5MVFPUitCRHA0VWkvN0FaWlMxUm40Z0F0Qm8yNQpUSFlqNXgzVVkyaVBPRldNWnJZZFA1c05oa0ZPRXRoU3IvNnNUb0l6dHdJT1NCcE5JZEF4cW1FUzUvS01KQ2lFCjdVSmo4M0ZmVW9jRElYZ2l5WE1WaWVKWnEzclpoMkozY0RuUnU3K1FnOFk2WVFOOWp0dz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
    client-key-data: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBM2RPUWJUVXNlTGVxeS9zSzNjK0huZ29vSDNRTjBscnM0cGNpNUU1Mnd6UVJTd29pCjJ3VlA4UERqMzhrSnJpeTY3Z3k1dUoySEVRUkMwTmtrMlhZSFNDekdhWXdlT2tHQkh0c3hsSDdmS2M2Umh5bHUKRVFPVW52WmFmdXN6clY1L3N2Q0gwRXhNalNGRVdSQ011YkRVVHZzMTA5S2hsalYwVXIyMmpjd0o5UjBxL0FpTAptNVkzbnM3R3IzOGtSUlJBSkliTzU2cmNsbVo2VXFhZFZGdlJSL3ZyZGV3THE1Y25wSnFQRG1sKzdkTk9rSWFFCkRDNU5xejBKVGsyeTFXbHpBRjdrUi9BNWRnZ3JwMlIwV2dNWmEwaVJlSG9ZWkwwdUk4WEVKaFprcEQzWlZUOVYKNS9QYS9IYmxSYnVyM0hCZ1pBcHl4aDZXaVFpS2VIL285Nm1PUlFJREFRQUJBb0lCQUh5bWRRTVpIVHRjb2lwcgprR2lpUktnSE54S3RxVktxYTNETTB2dU9KK2g3S3JpTElwa0d2Q3c5Z1I5d25mTDFDYm5aQnNmNkpUcm50UkFjCjVUc1p1dS9RMFZIZ1BlQW9qUUVrMVJDSDFxbHNmWlNCTUd0NUlwdk0vWDlTZGNDWFdKVFoyc2V2Q0ZsSjkxbEIKRm9NR0hkZWdERmhTaFNDZU94Wi9xc1MxZ21ic2lCcnBYRW5VODZOR2tXVzhEM1lmSUtiRWhCdUpCRy9aWGh2VApYMjNyNVB3QlFQZVFxamwrV0kzWjhwY3ArRVYyZ21tOEhTaEZWNnNta09FU1JSWmhiMEVGMElNM1pOYVJjSVJUCmo1eCt4TGJMRHE2cW04dFhMS3NuaGtxaEFoU3JhMWR2UTZkRWVUNGFkVFJucjNQbWVmVjhOMjBHQWwyY0YybnAKT2FEbWlLVUNnWUVBOVZ0MmZycWpzYTA1dXJVNW9sc1BkdDV2ZjdZU2FyblZQRDRBZWNYVWFrUWFQd0hHVUNMcwpxV2J3b3VIaGVmVm5jVGRKRi9TTHFGWXVPZFBwSlp1OFM3OXBaQTlHc1RSVk1oT1lESmJpMVNCRUtjb1MzM0ZjCnQvU0hLMDRISVpNdGFVS1A1VS9wSkQ4eS9WUzQ4NGVDV2U3alBlVWpJWVJNZjNEOXc3VXRVOE1DZ1lFQTUzTE8KV2oxZkxYaXE4aStORE5aSGptT1hld1BnQjl3OEs5cEoxOVUzTmlJcXowdWszbG80TmlBZDRoS2dYZ0lWMlQ3YwowYTlHOFc3WWswUjBwbW1vamRVcmRnWDhyWVlDUVZvMlcveHg0QUEvMG93aGRHMXFpb2s0N2JTejNlQ0dvZnB2ClBpb2psUng4NTlFNCtFMDIxZHhLU0xkdU9yU21wMFQ3ZU03WEhWY0NnWUVBc01Sa2Fva3N4aVYzSWZ6T3VSbkIKMm5JSEFvdTZXUW5waHExa3lsYXM0cUtPQmpiUkdZc1AxanhEd2hYYXpITHhRN0FCQ1RFMkxPRnFERitQNlhoNgpBRmkzSlUrY0xxNzFjazZMalFab0JnUnBGM0p1aG15MTBCSnNEOWIzYkVrTXZua21FcCt2NkYxZjd3UEsvQ2owCjBMWTdJYXlqMHRIdUN5THNzTU1uRk9FQ2dZQnBubCtDbUswZFlBcUttSjZDZENxVlZPZGtzTUVFZFVGVU5ib3EKNzFiUnNrZmM3MFVlWHdkMTA3UXZYWmFuTDhadXJCd3k2QXkwMG9Pc3VMbU8wM3FpdHR1dGNVLzhrOEhsdHRoRgpvKzhIYkxXelRGVmIveTUyWitaOXUwKzFlZWVXZFdWY2RmaGs3R29uazdldXYvVzlKRmtWMC9kT2ZPL3NOek9XCnpyVWw0d0tCZ0E4Qmo5K0dWZVJUbm9rUTZoWXVKTnZ1UEdOL3hDQk1lUk9CY2NtOW9mOGlZeHN5dFc2SE9FcDYKMWpydkNsalk2RE42N3J4SFI4UXB3cExKdXlhMUJ1YU5nZjlYbzdMNkNtLzg0Ym9BUndVK3BuNmNpSFozUWlzTwpCVWh1cHlDTEI1cXJsdnpvYlNQZDU1MGlOMWNWWldDNHNCYndraEFaNmw0MXByTDUyOVJSCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
#user info about cluster-2
- name: lke50150-admin
  user:
    as-user-extra: {}
    token: eyJhbGciOiJSUzI1NiIsImtpZCI6Imp4YmR4LUd1RDZ2SW9yNjVNU3NINHZBOV9id3VjeUZCTUZQRVd0SDlZMlEifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJsa2UtYWRtaW4tdG9rZW4tbXd2dGYiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoibGtlLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiZDAwMGM3YzctMGRmZC00MWQzLTkxYzEtYzUxNzEzYmE1MmNmIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmxrZS1hZG1pbiJ9.8qaUry2DR721RxA9diuU4VMrU2X7nvrSfibvBnVJmQ_qL_QGXc7gRplccq98Py4MdEo9DvTeqSBOpGtsrBHaROU4RCG_HaCJstAp2uLde5aDt9FdkSU85GjZy9R1Dee-ZdOrhRndvqrDX7tuZYWSdFxYrkCtAGu_sWgkYQeK5uCaRL5CuY188cGKzu_JK0NEUCso_v3o6V_94LCD7nlWq7JVh4wvMzQIRgEbloQIM1Iswp8LtHeSnjnXl6k9pW8qKZYH8nK6XnFZ5otpL4MS5hE9_pAvojG2hKK4DIIWtLC9TWYGEl6Vd_DdyHC1KOhXPqSMMQyDSYwGrkHE8GlTmA
contexts:
#context info about mgmt-cluster
- context:
    cluster: lke50149
    namespace: default
    user: lke50149-admin
  name: lke50149-ctx
#context info about cluster-1
- context:
    cluster: cluster1
    user: cluster1-admin
  name: cluster1-admin@cluster1
#context info about cluster-2
- context:
    cluster: lke50150
    namespace: default
    user: lke50150-admin
  name: lke50150-ctx
#current context (mgmt-cluster)
current-context: lke50149-ctx



export MGMT_CONTEXT=kind-mgmt-cluster
export REMOTE_CONTEXT1=lke49492-ctx
export REMOTE_CONTEXT2=lke49493-ctx 


export MGMT_CLUSTER=kind-mgmt-cluster
export REMOTE_CLUSTER1=lke49492
export REMOTE_CLUSTER2=lke49493


apiVersion: v1
clusters:
- cluster:
    insecure-skip-tls-verify: true
    server: https://213.52.130.149:36757
  name: mgmt-cluster
- cluster:
    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeU1ERXhOREUxTWpRek5Gb1hEVE15TURFeE1qRTFNalF6TkZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBSjN4CmNHSWd3OTY5a3RDK09Ddk1ZV1VUT3puVXZJd1hBSlN4amZJK1pIUWdmNkFqeTJSV2RONzFzVTVrNHpzV3lTV3oKbnlTTFhXM29Hc2ExY3hXbXZSeTUxcnV1QWl1Z2JVL1l5NGIydXNmRUo1MkRmVmIxZnAzZG1MMFI1OGVtVndmWgpUUTVqUytSZTc0U042TnFGWnplM2hwZ1h5K3oybFFnR1pBa2h3UWlmTDJyazhTdFgxR1k5RnZZRUhOWS9FZ0VvCjVEcTlIMTZ2emhpcUpFRFUxYTFwYlFGc0dDN25JejREbEZuZUpYWURhbVRXSVY1bnl0bGtSbEZWMnR0K29MbnIKd1ZMVXluT3BrQXRWQ3gwNkNOcUxSTVo0a1BodmJaN0hYZnZvakNIdTdsSnV6K1Z3V01wSUVnTGhGbnV1MlJpcQpYa2ZOQlpFOVJlU2VWMnlsTFdzQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZHSHB0Mi9iS2ZUc29WTUw4ZGo2Z0NBZ2UvcU5NQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFBSlNvTWw4TE8yS0J1VjNxVTVoVkd6Z0d0Z2xST1ZGWEpwdVFGTnJtMk1YaDZIV1FDdAp2bHNVVWpMYWNYY3A0b0YrOTBEU0RhdU1wNXh2SXpNdytTRjJESk92cFBtaWl5ejgxNVJJaTRwcTFyd2p3cUR3Ckhjd21qalZqNzdXaUVrSHhFb1hrV2tGUUVZcy81UXdWVC9QMFUwaTZGbVh4dVZXKzl0cGdHRGdhaTlVVHBZL3AKSUlCQm9SemkwamsxUGM1SWkwTzJBNms2R1FpOG5lWFJUdVc5V0pMZFVHbzBZSFdTK3N4dUV3TUx2MjU0aTQ2UQpaYld0MU9SVHM0NS90bWNlOGZ5Z2JwelM5Rm1sWnJFazIvaW1FV0dZOWFpa3NuVDJlNnJJanIxdjZHY0RUQXI5Cm94dXhwVmgyem1pTEpjQ05hOW16MmhvSk4wL0E5RCs3eTZobgotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    server: https://5b06b024-7a27-448e-9775-d535cefc0ff8.eu-west-1.linodelke.net:443
  name: lke49510
- cluster:
    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeU1ERXhOREUxTWpZeU9Gb1hEVE15TURFeE1qRTFNall5T0Zvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBS3M2Ckd5UXQ4TUdDMld3L3lramR6TTE2YjBTcHJTN1JYSCtOS1paTmVHZFhyc09vVW1ZYUp3OW5wSHFqQTBrVEpNdXQKSERUNmFyT3Bob09LeHpFQ2xPVEt2ditHT2hvWVRnb1M4T29YeXRySE1uN2tQRStVaThYUDRydHNJeXA0M0JZUQp0M3NaRTREYXAvUXpOTUdzcXdZWTFRTnRYNE9xQXJIWEc0ZTRTUFA5RE0vWW5DZnZBSDJKVEg2RWNyZXhNcC9ZCkxxN1ZRTWZGUnZPaEFYY3I0UmlYbGhqTUpZR3lNcXAxQUd4UlRpbmdId2RXbGZkMHFrallCU042TUxET1Rkb2MKdUhHaGZraWNOSmdlRnlwalg0UHMxWm1zZ3BhcWhkUTF1K01oSGpsdzIwZHJneGd3ZkdUQnNsTFQzZTdWNHVrTApBZHhzUHNkOG53NUNWc1B3aDVrQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZJWW5jQXJ3VGtBcnpFcVI4YjBndDNWV2t4bkpNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFBMU0rb3FUaGhoQlVYeUZVckw4YlZVL1dpS2tzTFlheUtxZ1ZJSnB5RXNaOVpJTWpQVwplMjFvZmJFbU4vNUx3MllHbVZvYlVlWWoxOUNaVm10bThId2FNeW56ZGpwemlNbUtEb0NxMzd4Tmw2bGtYZHROCmRKZVB6dEF6czB0Z2ZnWVU1L2RmQ1dNK1hxa2hXOW5QYjhEWFpSSk4rMExqREpNcG9JMXlDc1EzYUR6Qi9Xd1UKZVZjUS9TVHdHYWxpeUdYTW5qaDVaZFpHb2Y2d3lNdkw0ZlExeUtCZzl1czFYTnZNcHdpQU9OektaTzhXd1ZRaQplTVM1N2JOM0Y4Ulh1WGg1WHFmczQ2VmNMOFhoWU1ieVUxeHU3Ty9EM0sybUQ1b25MOVNTVmVqcmF5cHVMdmY5CmtINUc3SjcrbHJqeGZidFF5bURZV1RnTHp3V2s2WXdxWW9HWgotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    server: https://a5ae02dd-6f26-4db7-9462-e7a128dd6859.eu-west-1.linodelke.net:443
  name: lke49511
contexts:
- context:
    cluster: mgmt-cluster
    user: mgmt-cluster-admin
  name: mgmt-cluster-admin@mgmt-cluster
- context:
    cluster: lke49510
    namespace: default
    user: lke49510-admin
  name: lke49510-ctx
- context:
    cluster: lke49511
    namespace: default
    user: lke49511-admin
  name: lke49511-ctx
current-context: mgmt-cluster-admin@mgmt-cluster
kind: Config
preferences: {}
users:
- name: mgmt-cluster-admin
  user:
    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM4akNDQWRxZ0F3SUJBZ0lJT0tKZElZZ0swbHN3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TWpBeE1UUXhOVEE0TWpoYUZ3MHlNekF4TVRReE5URXpNamxhTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTJTNkdIczlyUCt4RXJITFAKZ3FxekVEZG92TjJ2WWNmdE1BdDkvZ3pDeUNJUU5FbkRpdGNIWFlsN1ZTOTVvNm1POUNjNzFnTEVjbWY5Y0drWApZbTE1aGFCdUJBd096Qyt4OE5NZE9sRmZ4YUJHN1JLT3hMUmkrQmlSMi9yaDFiR3RRUmZMV3hqTjRXQWp2T29GClg3MytPdnFYRVE5Y25SOXdEci9uOUFXQ3BVbXZMa09iR1JDTXQ5ZVhhOTh4TXlNcVdNQXFtc29BLzZLVmFXUkYKbXdFcnVnNk5sK203ZFdSd1RwVGdyR0d1UFYrdGpHbVk0dkRVL0hBSGJodTJXb3lEdDlCclhtdW54VWk5eitscAp3bmtESWQrTHpMMXg3Z29wc2QrQ0lNNGlkb0wwTVYzVzdIdytIRHQ2bXVObVIvRmNJb2gxNmczSWpscWl6MDQ5CnlOZElTUUlEQVFBQm95Y3dKVEFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFJOHhNRW5GNGJBQ3JVU1p6Q3d5aVhMa0pyaWNjT0FQOC9oRwp4Z0srakhSR2dqazZNRkVYOE5iWGJUUDF6TU93ZUY2YUk3V01NamlpSWRsK05jeVVqR2JkSFhSL1M2U24ycFc0ClU2MndydzlpVTFmb3hkcWRGTWwxNUk3QzJBVnVKaStrWTFiYWpGaWVORDhuZ1JyYnNmRmM5TERnVndVZjd1c20KM05xd0FFRDNINUZuTnNsMldLcWs2bzdPTzNkc21JbytYRHg3d0VWS3R3NTVXSGJ5UzFQay9ONEhiaUMxYmwrbApNcDZMT2doSXRGWkFHZ28yK0JxejYyWmZ1aHhvWStka2thUkxDQTRabFQ2WDN3SldsRE5EOW5WdEdSS0grYnMwCmtrQ3FkRlJhcjlFam51SDJyUGZ3UE1zSU1BN2lncmt1cG9LTjFPN3VDdUs2RGVINE1ZMD0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
    client-key-data: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBMlM2R0hzOXJQK3hFckhMUGdxcXpFRGRvdk4ydlljZnRNQXQ5L2d6Q3lDSVFORW5ECml0Y0hYWWw3VlM5NW82bU85Q2M3MWdMRWNtZjljR2tYWW0xNWhhQnVCQXdPekMreDhOTWRPbEZmeGFCRzdSS08KeExSaStCaVIyL3JoMWJHdFFSZkxXeGpONFdBanZPb0ZYNzMrT3ZxWEVROWNuUjl3RHIvbjlBV0NwVW12TGtPYgpHUkNNdDllWGE5OHhNeU1xV01BcW1zb0EvNktWYVdSRm13RXJ1ZzZObCttN2RXUndUcFRnckdHdVBWK3RqR21ZCjR2RFUvSEFIYmh1MldveUR0OUJyWG11bnhVaTl6K2xwd25rRElkK0x6TDF4N2dvcHNkK0NJTTRpZG9MME1WM1cKN0h3K0hEdDZtdU5tUi9GY0lvaDE2ZzNJamxxaXowNDl5TmRJU1FJREFRQUJBb0lCQUJJZDhteEJpMFhTMU11NQo3QnVQVjg2amdLWTRxL2V4TU5VUU1GdHYveE9vMjhjdzNCSUo3QUJlaHA1TmpvMGJpT1JQSFl1MXdXTjF6MHVBClNNWWFNY2YyNFJhUFZ2Q3JqZUYwQ3YwaGFxYld2dlBwMTJVTFV6STFBbjNpU05LRnR0azJQZTJFZlRBdXoreGoKYlQxV1lRM1VkNk9ocjIwZ0FUNEp2alM1L1BNQ3NqV2huQ3MrLzdkN2x5ZXRHV3U5cmp3SFhqYjRqdkVnNk8vdwpvSkR2T2pMNjRqWGl2UGJTTmpweWdZNVV0UHJ4L2ZyZTFTanMxNWRvbmtrM2JNTzcrSkVhbWoyN2VGUVpaYjVsCk5zTEtKYkJXaC81bVFLdlMxWlRNemkxRFAwaG1MT2c3TnhXZTJMYlgycWtqZHFDcDl5ZE5MNGhHYytTWnhBOXMKTkQ1M1JQRUNnWUVBNk45K2VTcnJ5bnBUNkFZQkJBZHBZREorM3kyQ3E5Qjd2RlAyOURualdLWkZuUHpBYXhPUQppeFhIcnFmOTQrSXhCenNjS2txTVUyTDVlK2tpNS9uM25RVmZ4U3VhVGRnRUZnanZEdG5jalMzN3dHVGU2aTRRCkpDM0lZZUhYdWl6WnkyWXYyV1d6by92V25vVDhjV0JjQUcrRk52dHJoZFRPV0FXMzFsd3pxb1VDZ1lFQTdzQVoKTWYrYUc0UUZSVkxZTFptSFo5UGI4MnlXUFVWQ3dPR29TNlBta0NjUzBySGY1YTkxS2NxdG9seUJPczE4bm9FSApBUEJ0R1I0MHhLZkhCOU5wa3BmaHJBay8yOWZ0bk1oaWZWOXFBWno0UGY1RG9BeWJtYjBiVjJkK2paUC82aEwxCmRNRVY4WkRrS0RuRDhRTVc3M2lPcytJSnlUVXZpMzRqUmdGNTYvVUNnWUVBemJmNSswSmVjRTFtYURjOW1IaVAKcjJxTVI4M2xmTEM5VGw2Q2I3ZmZ6Z1Y4dzdWSXFvN3JCdU5qdGpnemdxZmtGZll5NkcxWXo2VkVyaUVETkJqUApsSWdWMVpHeVM0aEQrODlDbUVUL29EeDZCTGxYYjFybjZYNEVZZXZuN2xFR3liZHBGOHpQU0ZNR2dwMEtnWUhWClpKRWdCclZPaERpOVhHY1l3eVpLZ2gwQ2dZQWQ5cXZ5MDNKaTI2blJybmtGR0F5ZllqNXJpWWc5ZmxESFprcTUKMjRNWE9tQXBZenVIVndMc1VNeUQ0UG96Q0JFSXo0YXlmbm9pdWVERGdZOEFFMjlmZjRKS0Znc1dxejNkL0dRbgorZTZTNzBGVWZuRzhSM2pMemFqOXlqWmV6R0ZFM2taQjllMnNHSlFaM0U0VUZHQXZnOERkSUpRNzFWbjNOc2gwCmc4RHFkUUtCZ0U3NjV1VXduMkdldkZHVHF5K1NDV3g5VFdNRC83YkVTeHRBNnNVWkxkaUl6dW10TmszVEJPbUkKY0FMK1Rldld4dG5YUmJSWlZhZEo2REpTdkFqeUVlbHUvVmRIWHQyRUJ3TlRPVWFXUzVHVWVPT09LcU1xc1VJcApHR2xSZ2tJYlI2cGdIV0RTdUpnKy9kbmdKZis0TlVvckxSWHllWmNoMFQ2T0ZMUE15MmJCCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
- name: lke49510-admin
  user:
    as-user-extra: {}
    token: eyJhbGciOiJSUzI1NiIsImtpZCI6Im1HbENXSlpzczFFaFJmUDBLQ19wajVpY01WTTFMdWRIZzJnTFIyb1l5eHMifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJsa2UtYWRtaW4tdG9rZW4tNWZucGMiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoibGtlLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNGY3MDQ0ODAtZTM4ZS00NWU2LTljNWYtMzlhN2MyNDdhODQ3Iiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmxrZS1hZG1pbiJ9.CSO6uL4NizGLpLJhrzOTpneJqoewc_BAHWwS7SSYq2OpQWDtp9B0LtQ9miYLKWK0Iud0HkDOs8kku-DDyLh4v6Wpw1Pi3kec9iQcJpWIyzlR5PNXIMH8U7K0Q5n0HPk09S3R4NbnYlpqx-0DnzS0HugXTbMaWRRjGYGhNkuDQ4_rNUhuUbE8c5nkp6IlfHLxWG-Mm2xRzyEheuOiaWlbvbNY0_LSuupTxpEwGgFB4mhJse7_zjHS_M4yMyl1pZmNTBP4kA2npPAZ6H7N5QYo2tJuhIxV6jLR_YVfjeSv53I2Ii6779skMEuV9eW-QhM2qxzqNLvUSy6soY6DZPgfBA
- name: lke49511-admin
  user:
    as-user-extra: {}
    token: eyJhbGciOiJSUzI1NiIsImtpZCI6IlVwTmVHU21ZVmthTE41T0M1SVZieGJaUDNaY3lwTUpuSHVKTXFoMkt2MXMifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJsa2UtYWRtaW4tdG9rZW4tcm5ueDIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoibGtlLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiOTE1YzlmZDMtNDUyMS00YjhhLTk4YTYtYmEyNTUwMzQ2NTZjIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmxrZS1hZG1pbiJ9.UBuGdWCfpqw9GFbLDlhbgbrih1qWXut3-owUIrcSgakAjazeVp1vOsseI1XVqR_WsvddK0QGFRlZyX0g5LZxiIzNnkLVuTl0XU39CK3n1ZI82BXYBib9W_Rv9EFgBlwyMModJ1-5Oa6_jy2x-lbhCfGGRZtr3yw-GBBzh-WCNT6DS1T8oDWWUzXK50VaLnFWxXAapWXG-frpq9TCCKOAdHo28tioFSQMZQ0EgQoMVeeZlciVAuzcnSeD7vyCCV8TTj1CM5EE61AR1Ou7amxAw_tE5sWAWxG9GshBirpQji264NVYkhnaJzstN0ab1gHe63QICRPt3XoZZZCoSIKk6g



export MGMT_CONTEXT=lke49510-ctx
export REMOTE_CONTEXT1=mgmt-cluster-admin@mgmt-cluster
export REMOTE_CONTEXT2=lke49511-ctx

export MGMT_CLUSTER=lke49510
export REMOTE_CLUSTER1=mgmt-cluster
export REMOTE_CLUSTER2=lke49511

kubectl --context ${REMOTE_CONTEXT1} apply -f https://raw.githubusercontent.com/linsun/istio-yamls/main/gm-eks/mtls.yaml
kubectl --context ${REMOTE_CONTEXT2} apply -f https://raw.githubusercontent.com/linsun/istio-yamls/main/gm-eks/mtls.yaml


helm repo add gloo-mesh-enterprise https://storage.googleapis.com/gloo-mesh-enterprise/gloo-mesh-enterprise
helm repo update
kubectl --context ${MGMT_CONTEXT} create ns gloo-mesh

helm install gloo-mesh-enterprise gloo-mesh-enterprise/gloo-mesh-enterprise \
--namespace gloo-mesh --kube-context ${MGMT_CONTEXT} \
--version=1.1.1 \
--set licenseKey=${GLOO_MESH_LICENSE_KEY}

kubectl --context ${MGMT_CONTEXT} -n gloo-mesh rollout status deploy/enterprise-networking

SVC=$(kubectl --context ${MGMT_CONTEXT} -n gloo-mesh get svc enterprise-networking -o jsonpath='{.status.loadBalancer.ingress[0].*}')
meshctl cluster register --mgmt-context=${MGMT_CONTEXT} --remote-context=${REMOTE_CONTEXT1} --relay-server-address=$SVC:9900 enterprise cluster1 --cluster-domain cluster.local
meshctl cluster register --mgmt-context=${MGMT_CONTEXT} --remote-context=${REMOTE_CONTEXT2} --relay-server-address=$SVC:9900 enterprise cluster2 --cluster-domain cluster.local


kubectl apply --context $MGMT_CONTEXT -f - << EOF
apiVersion: networking.mesh.gloo.solo.io/v1
kind: VirtualMesh
metadata:
  name: virtual-mesh
  namespace: gloo-mesh
spec:
  mtlsConfig:
    autoRestartPods: true
    shared:
      rootCertificateAuthority:
        generated: {}
  federation:
    selectors:
    - {}
  globalAccessPolicy: DISABLED
  meshes:
  - name: istiod-istio-system-cluster1
    namespace: gloo-mesh
  - name: istiod-istio-system-cluster2
    namespace: gloo-mesh
EOF


kubectl --context ${REMOTE_CONTEXT1} label namespace default istio-injection-
kubectl --context ${REMOTE_CONTEXT1} delete -f https://raw.githubusercontent.com/linsun/istio-yamls/main/gm-eks/bookinfo-cluster1.yaml
kubectl --context ${REMOTE_CONTEXT2} label namespace default istio-injection-
kubectl --context ${REMOTE_CONTEXT2} delete -f https://raw.githubusercontent.com/linsun/istio-yamls/main/gm-eks/bookinfo-cluster2.yaml

kubectl --context ${REMOTE_CONTEXT1} port-forward deploy/istio-ingressgateway -n istio-system 8080
open http://localhost:8080/productpageCopied

cat << EOF | kubectl --context $MGMT_CONTEXT create -f -
apiVersion: networking.mesh.gloo.solo.io/v1
kind: TrafficPolicy
metadata:
  namespace: gloo-mesh
  name: simple
spec:
  sourceSelector:
  - kubeWorkloadMatcher:
      namespaces:
      - bookinfo
  destinationSelector:
  - kubeServiceRefs:
      services:
        - clusterName: ${REMOTE_CLUSTER1}
          name: reviews
          namespace: bookinfo
  policy:
    trafficShift:
      destinations:
        - kubeService:
            clusterName: ${REMOTE_CLUSTER2}
            name: reviews
            namespace: default
            subset:
              version: v3
          weight: 75
        - kubeService:
            clusterName: ${REMOTE_CLUSTER1}
            name: reviews
            namespace: default
            subset:
              version: v1
          weight: 15
        - kubeService:
            clusterName: ${REMOTE_CLUSTER1}
            name: reviews
            namespace: default
            subset:
              version: v2
          weight: 10
EOF






apiVersion: v1
kind: ConfigMap
metadata:
  namespace: metallb-system
  name: config
data:
  config: |
    address-pools:
    - name: default
      protocol: layer2
      addresses:
      - 172.18.255.1-172.18.255.250



export MGMT_CONTEXT=lke50149-ctx
export REMOTE_CONTEXT1=cluster1-admin@cluster1
export REMOTE_CONTEXT2=lke50150-ctx 

export MGMT_CLUSTER=lke50149
export REMOTE_CLUSTER1=cluster1
export REMOTE_CLUSTER2=lke50150
